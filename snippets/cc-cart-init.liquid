<script>
  document.addEventListener("DOMContentLoaded", cartInit());

  function cartInit() {
    if (Aurigma.CcHelper == undefined || Aurigma.Storefront.projectsBufferUrl == undefined) {
      const ecommerceSystem = {
        {%  if customer %}
          userId: ShopifyInit.getUserIdForCc('{{shop.domain}}', '{{ customer.id }}'),
        {%  else %}
          userId: ShopifyInit.getUserIdForCc('{{shop.domain}}'),
        {% endif %}
        pluginSettings: { currency: ShopifyInit.getCurrency() },
        tenantId: '1162',
        storefrontId: '1131',
        existingOrder: ShopifyInit.getExistingOrder()
      };
      new CcHelper().loadProductForCc().then(ccProduct => {
          let tenantId = ecommerceSystem.tenantId.toString();
          let bufferUrl = "https://cch-apigateway.azurewebsites.net/api/buffer/v1" + `/tenants/${tenantId}/projects`;
          Aurigma.CcHelper = new CcHelper(tenantId, bufferUrl);
          prepareInterface();
          Aurigma.CcHelper.renderCart();
      });
    } else {
      Aurigma.CcHelper.renderCart();
    }
  }
</script>